<div class="register-page">
  <div class="promo-panel">
    <div class="brand-pill">
      <mat-icon>bolt</mat-icon>
      <span>FactuFast</span>
    </div>
    <h1>Impulsa tu facturación sin complicaciones</h1>
    <p class="promo-subtitle">
      Regístrate en minutos y centraliza tus clientes, facturas y cobros en una sola plataforma moderna.
    </p>

    <ul class="promo-list">
      <li>
        <mat-icon>check_circle</mat-icon>
        <span>Dashboard en tiempo real con métricas críticas de tu negocio</span>
      </li>
      <li>
        <mat-icon>check_circle</mat-icon>
        <span>Importación masiva de facturas y clientes desde planillas CSV</span>
      </li>
      <li>
        <mat-icon>check_circle</mat-icon>
        <span>Alertas inteligentes sobre pagos, expiraciones y tareas pendientes</span>
      </li>
    </ul>
  </div>

  <div class="form-panel">
    <div class="form-card">
      <div class="form-header">
        <h2>Crear cuenta en FactuFast</h2>
        <p>Completa el formulario y comienza a automatizar tu facturación hoy mismo.</p>
      </div>

      <form [formGroup]="registerForm" (ngSubmit)="onSubmit()" class="register-form">
        <div class="form-grid">
          <mat-form-field appearance="outline">
            <mat-label>Nombre completo</mat-label>
            <input matInput
                   formControlName="name"
                   placeholder="Ej: Juan Pérez"
                   [class.is-invalid]="registerForm.get('name')?.invalid && registerForm.get('name')?.touched">
            <mat-icon matSuffix>person</mat-icon>
            <mat-error *ngIf="registerForm.get('name')?.invalid && registerForm.get('name')?.touched">
              {{ getErrorMessage('name') }}
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Correo electrónico</mat-label>
            <input matInput
                   type="email"
                   formControlName="email"
                   placeholder="tu-email@ejemplo.com"
                   [class.is-invalid]="registerForm.get('email')?.invalid && registerForm.get('email')?.touched">
            <mat-icon matSuffix>email</mat-icon>
            <mat-error *ngIf="registerForm.get('email')?.invalid && registerForm.get('email')?.touched">
              {{ getErrorMessage('email') }}
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline" class="grid-span-2">
            <mat-label>Nombre de la empresa</mat-label>
            <input matInput
                   formControlName="company_name"
                   placeholder="Ej: Mi Empresa S.A."
                   [class.is-invalid]="registerForm.get('company_name')?.invalid && registerForm.get('company_name')?.touched">
            <mat-icon matSuffix>business</mat-icon>
            <mat-error *ngIf="registerForm.get('company_name')?.invalid && registerForm.get('company_name')?.touched">
              {{ getErrorMessage('company_name') }}
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline" class="grid-span-2">
            <mat-label>RUT de la empresa</mat-label>
            <input matInput
                   formControlName="company_tax_id"
                   placeholder="Ej: 12.345.678-9"
                   [class.is-invalid]="registerForm.get('company_tax_id')?.invalid && registerForm.get('company_tax_id')?.touched">
            <mat-icon matSuffix>badge</mat-icon>
            <mat-error *ngIf="registerForm.get('company_tax_id')?.invalid && registerForm.get('company_tax_id')?.touched">
              {{ getErrorMessage('company_tax_id') }}
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Contraseña</mat-label>
            <input matInput
                   [type]="hidePassword ? 'password' : 'text'"
                   formControlName="password"
                   placeholder="Mínimo 8 caracteres"
                   [class.is-invalid]="registerForm.get('password')?.invalid && registerForm.get('password')?.touched">
            <button mat-icon-button
                    matSuffix
                    type="button"
                    (click)="hidePassword = !hidePassword"
                    [attr.aria-label]="'Mostrar u ocultar contraseña'"
                    [attr.aria-pressed]="!hidePassword">
              <mat-icon>{{ hidePassword ? 'visibility_off' : 'visibility' }}</mat-icon>
            </button>
            <mat-error *ngIf="registerForm.get('password')?.invalid && registerForm.get('password')?.touched">
              {{ getErrorMessage('password') }}
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Confirmar contraseña</mat-label>
            <input matInput
                   [type]="hideConfirmPassword ? 'password' : 'text'"
                   formControlName="password_confirmation"
                   placeholder="Repite tu contraseña"
                   [class.is-invalid]="registerForm.get('password_confirmation')?.invalid && registerForm.get('password_confirmation')?.touched">
            <button mat-icon-button
                    matSuffix
                    type="button"
                    (click)="hideConfirmPassword = !hideConfirmPassword"
                    [attr.aria-label]="'Mostrar u ocultar confirmación de contraseña'"
                    [attr.aria-pressed]="!hideConfirmPassword">
              <mat-icon>{{ hideConfirmPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
            </button>
            <mat-error *ngIf="registerForm.get('password_confirmation')?.invalid && registerForm.get('password_confirmation')?.touched">
              {{ getErrorMessage('password_confirmation') }}
            </mat-error>
          </mat-form-field>
        </div>

        <div class="password-hint">
          <mat-icon>lock</mat-icon>
          <span>Utiliza al menos 8 caracteres y combina letras y números para mayor seguridad.</span>
        </div>

        <div class="terms-section" [class.invalid]="registerForm.get('terms')?.invalid && registerForm.get('terms')?.touched">
          <mat-checkbox formControlName="terms" color="primary">
            Acepto los
            <a href="/terms" target="_blank">términos y condiciones</a>
            y la
            <a href="/privacy" target="_blank">política de privacidad</a>.
          </mat-checkbox>
          <div class="terms-error" *ngIf="registerForm.get('terms')?.invalid && registerForm.get('terms')?.touched">
            Debes aceptar los términos para continuar.
          </div>
        </div>

        <button mat-raised-button
                color="primary"
                type="submit"
                class="register-button"
                [disabled]="loading">
          <mat-icon *ngIf="loading" class="spinning">hourglass_empty</mat-icon>
          <span *ngIf="!loading">Crear cuenta gratuita</span>
          <span *ngIf="loading">Creando cuenta...</span>
        </button>

        <div class="login-link">
          <span>¿Ya tienes una cuenta?</span>
          <button mat-button
                  color="primary"
                  type="button"
                  (click)="goToLogin()">
            Iniciar sesión
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
